---
title : "조인 테이블"
categories : 
    - jpa
tags : 
    - java
    - spring
    - jpa
sidebar:
    title: "JPA"
    nav : sidebar-posts
---  

데이터베이스에서 테이블의 연관관계를 설계하는 방법은 크게 2 가지로 나눌 수 있다.  

- 조인 컬럼 사용(외래 키)
- 조인 테이블 사용(테이블 사용)

## 조인 컬럼 사용  

테이블 간의 관계는 주로 조인 컬럼이라 부르는 외래 키 컬럼을 사용해서 관리 한다.  

![조인컬럼](/assets/img/JPA/조인컬럼.PNG)  

![조인컬럼데이터](/assets/img/JPA/조인컬럼데이터.PNG)  

회원이 사물함을 사용하기 전까지는 아직 둘 사이에 관계가 없으므로 MEMBER 테이블의 LOCKER_ID 외래 키에 null을 입력해 두어야 한다.  

**외래 키에 null을 허용하는 관계를 선택적 비식별 관계**라 한다.  

선택적 비식별 관계는 외래 키에 null을 허용하므로 회원과 사물함을 조인할 때 OUTER JOIN(외부 조인)을 사용해야 한다.  

실수로 INNER JOIN(내부 조인)을 사용하면 사물함과 관계가 없는 회원은 조회되지 않는다.  

그리고 회원과 사물함이 아주 가끔 관계를 맺는다면 외래 키 값 대부분이 **null**로 저장되는 단점이 있다.  

## 조인 테이블 사용  

![조인테이블](/assets/img/JPA/조인테이블.PNG)  

![조인테이블데이터](/assets/img/JPA/조인테이블데이터.PNG)  

조인 테이블이라는 별도의 테이블을 사용해서 연관관계를 관리한다.  

조인 컬럼을 사용하는 방법은 단순히 외래 키 컬럼만 추가해서 연관관계를 맺지만 조인 테이블을 사용하는 방법은 연관관계를 관리하는 조인 테이블(MEMBER_LOCKER)을 추가하고 여기서 두 테이블의 외래 키를 가지고 연관관계를 관리한다.  

위 그림을 보면 MEMBER와 LOCKER에는 연관관계를 관리하기 위한 외래 키 컬럼이 존재하지 않는다.  

조인 테이블의 가장 큰 단점은 테이블을 하나 추가해야 한다는 점이다.  

이러면 관리해야 하는 테이블이 늘어나고 회원과 사물함 두 테이블을 조인하려면 MEMBER_LOCKER 테이블 까지 추가로 조인해야 한다는 점이 있다.  

**기본은 조인 컬럼을 사용하고 필요하다고 판단되면 조인 테이블을 사용하도록 하자**  

- 객체와 테이블을 매핑할 때 조인 컬럼은 **@JoinColumn**으로 매핑하고 조인 테이블은 @JoinTable로 매핑한다.
- 조인 테이블은 주로 다대다(N:M) 관계를 일대다(1:N), 다대일(N:1) 관계로 풀어내기 위해 사용한다.
- 하지만 일대일(1:1), 일대다(1:N), 다대일(N:1) 관계에서도 사용한다.

> 조인 테이블을 연결 테이블, 링크 테이블로도 부른다.  


---

## 출처  
- **자바 ORM 표준 JPA 프로그래밍 김영한 저**  
- **인프런: 자바 ORM 표준 JPA 프로그래밍 - 기본편**  