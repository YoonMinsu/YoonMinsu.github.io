---
title   : "관계의 유형"
categories : 
    - DB
tags : 
    - DataBase
sidebar:
    title: "DataBase"
    nav : sidebar-posts
---  

두 테이블의 레코드 사이에 몇 가지 방법을 통해 연관을 지을 수 있을 때 관계는 두 테이블 사이에 존재한다.  

기본 키와 외래 키의 집합을 통해 관계를 설정할 수 있다. 혹은 연결 테이블(linking table: 혹은 연관 테이블) 또 다른 세 번째 테이블을 통해 설정할 수도 있다.  

관계를 설정하는 방법은 테이블 사이에 존재하는 관계의 유형에 따라 달라진다.  

## 관계의 유형  

테이블 사이에 존재할 수 있는 **기수(Cardinality: 카디널리티)**라 부르는 관계에는 **1:1, 1:N, N:M**의 세 가지 유형이 있다.  


### 1:1 관계  

첫 번째 테이블의 한 개의 레코드와 두 번째 테이블의 한 개의 레코드에만 연결되어 있고 반대의 경우에도 서로 한 개의 레코드에만 연결되어 있을 때 이 관계를 1:1 관계라고 한다.  

이런 종류의 관계에서는 첫 번째 테이블을 __부모__ 테이블이라 하고, 두 번째 테이블을 __자식__ 테이블이라 한다.  

1:1 관계는 부모 테이블의 기본 키(Primary Key)를 자식 테이블의 구조에 외래 키로 넣어 이 관계를 만든다.  

이 관계는 두 개의 테이블이 같은 기본 키를 공유할 수 있는 유일한 관계이다.  

![ex](/assets/img/database/ex1.PNG)  

위 그림의 예로 **Employee** 테이블이 부모가 되고 **Compensation** 테이블이 자식 테이블이 된다.  

테이블의 관계는 **Employee** 테이블의 한 개 레코드가 **Compensation** 테이블의 한 개 레코드와 연결되며 반대역시 똑같다.  

위 두 테이블 모두 Employee_id가 기본키이다. 하지만 자식 테이블인 **Compensation**에서는 외래 키의 역할도 같이 수행한다는 사실을 잊지 말자.  

### 1:N 관계  

첫 번째 테이블에 있는 한 개 레코드가 두 번째 테이블에 있는 여러 레코드와 연결되지만, 두 번째 테이블에 있는 한 개의 레코드는 첫 번째 테이블에 있는 오직 한 개의 레코드에만 연결할 수 있을 때 성립하는 관계이다.  

1:1 관계에서 부모/자식 모델역시 1:N관계에서도 적용 할 수 있다.  
이 경우 "1"에 해당하는 테이블을 부모 테이블로 "N"에 해당하는 테이블을 자식 테이블로 설정하면 된다.  

1:N 관계에서는 부모 테이블의 기본 키를 자식 테이블 구조에 외래 키로 넣음으로써 설정할 수 있다.  

![ex2](/assets/img/database/ex2.PNG)  

Agents 테이블에 있는 한 개의 레코드가 Entertainers 테이블에 있는 한 개 이상의 레코드들과 연결되어 있다.  

하지만 Entertainers 테이블에 있는 한 개의 레코드는 Agentes 테이블에 있는 한 개의 레코드에만 연결 될 수 있다.  

Agent_id는 Entertainers 테이블의 외래 키이다.  


### N:M 관계  

첫 번째 테이블에 있는 한 개의 레코드가 두 번째 테이블에 있는 **다수**의 레코드들과 연결 될 수 있고, 두 번째 테이블에 있는 한 개의 레코드가 첫 번 째 테이블에 있는 **다수**의 레코드들과 연결될 수 있을 때 이 두 테이블을 **N:M(다대다)** 관계에 놓여있다고 표현한다.  

이런 관계는 연결 테이블을 통해 설정한다. 연결 테이블은 한 개의 테이블에서 다른 테이블에 있는 레코드들을 연결하는 것을 쉽게 해주며, 관련된 데이터를 추가/삭제/수정하는 데 아무런 문제가 없도록 해준다.  

관계가 있는 각 테이블의 기본 키를 복사하고, 새로운 테이블 구조를 형성하기 위해 이들을 사용하여 연결 테이블을 정의한다.  

이 필드들은 실제로 두 가지 별개의 역할을 수행하는데, 각 필드를 하나로 묶어서 연결 테이블의 조합 기본키를 형성하는 것과 개별 필드들은 각 테이블의 외래 키 역할을 한다.

학생과 수업의 관계를 생각해보자. 학생은 여러 개의 수업을 들을 수 있고, 수업 역시 여러 명의 학생이 들을 수 있다. 이 경우 어떻게 해결 해야 할까?  

![ex3](/assets/img/database/ex3.PNG)  

주된 문제는 어떻게 하면 첫 번째 테이블의 레코드와 두 번째 테이블의 레코드를 쉽게 연결할지에 대한 것이다. 위 그림을 통해 생각해보면 여러 학생들을 특정 수업에 연결하거나 한 학생이 여러 수업들을 연결하기 위해 Classes 테이블에 Student 테이블의 필드를 넣거나 Student 테이블에 Classes 테이블의 필드를 넣을지에 대한 질문이 된다.

이와 같은 접근 방법은 이런 테이블에 있는 데이터로 작업을 하기에 많은 어려움을 준다. 간접적으로 데이터 무결성에 영향을 주게 된다. 

![ex4](/assets/img/database/ex4.PNG)  

이를 해결하기 위한 가장 좋은 접근 방법은 연결 테이블을 만들어 사용하는 것이다. 그리고 이것이 N:M 관계를 풀 수 있는 가장 적절하고 효율적인 방법이다.  